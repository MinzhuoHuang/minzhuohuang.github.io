---
layout:     post
title:      模拟退火算法
subtitle:   
date:       2025-06-13
author:     Kubrick
header-img: img/post-algo-cover.jpg
catalog: true
tags:
    - OR
---

# 前言

本篇主要介绍一些关于模拟退火算法的基础概念与相关应用.

# 算法思想

模拟退火算法，英文名称为Simulated Annealing Algorithm. 作为元启发算法的一种，其设计被冶金学与材料工程中一种名为‘退火’的处理手段所启发. 

退火，是一种金属热处理工艺，指的是将金属加热到到高于再结晶温度的某一温度并维持此温度一段时间，然后以适宜的（通常为缓慢的，有时则会刻意控制）速度冷却金属. 退火的功用在于恢复该金属因冷加工而降低的性质，增加柔软性、延展性和韧性，并释放内部残留应力、以及产生特定的显微结构.

!['退火过程物理示意图'](/img/SA_pic.png)

退火过程分为三个阶段.

* 第一阶段：回复（recovery）
  
  在回复的过程中，晶体内部缺陷（例如晶格空位）会移动回复到正常晶格位置，同时内部应力场也会跟着消失。在回复阶段，先前的冷加工过的金属其电、热传导等性质将回复成原来状态.

* 第二阶段：再结晶（recrystallization）
  
  再结晶过程中，新的晶粒成型并取代原本因内在应力而变形的晶粒.

* 第三阶段：晶粒成长（grain growth） 
  
  再结晶完成时，晶粒成长（grain growth）就会开始. 晶粒成长过程中，小的晶粒会与大的晶粒合并，减少材料内部晶界的数目。晶粒成长的程度会严重影响到材料的机械性质. 从热力学角度分析，晶粒中的原子在经过缓慢降温的过程时，有机会找到比前一状态时内能更低的位置，从而形成更大的晶粒，减少晶格的缺陷.

!['模拟退火算法流程图'](/img/SA_diagram.png)

而模拟退火算法的过程也是依据上述三个阶段来定义：

* 第一阶段：升温阶段（初始化）

  在初始阶段，先获得一个初始解 $S_0$，以及假设一个足够大的初始温度 $T_0$，以及马尔科夫链长度 $L$ . 

* 第二阶段：等温阶段（内循环，产生新解）
  
  在该阶段，新解 $S'$ 将会按照某种机制生成. 常见的机制为对原有解 $S$ 的部分元素进行置换，互换或者反演等. 产生新解 $S'$ 后，该解将会按照某种判断标准来决定是否用新解取代旧解，目前常用的标准是 Metropolis 准则. 
  
  Metropolis 准则构成了SA算法的内循环部分，该准则的具体定义是：在当前温度 $T$ 下，迭代 $L$ 次，（ $L$ 为马尔科夫链长度 ），找出该温度下的能量的最小值（即最优解）. 而能量函数通常为所求问题的目标函数 $\mathbb{f(s)}$. 如果 $\mathbb{f(s')} < \mathbb{f(s)}$, 则算法接受新解 S' 为当前最优解, 如果 $\mathbb{f(s')} \geq \mathbb{f(s)}$，则算法会以一定概率接受最新解. Metropolis 准则中使用的概率函数为 $\large P = \mathbb{e}^{\frac{-\Delta E}{kT}}$，其中 $\Delta E = \mathbb{f(s')} - \mathbb{f(s)}$， $k$ 为玻尔兹曼常数， $T$ 为当前状态温度.

* 第三阶段：降温过程（外循环，算法收敛）

  在上一阶段中，当内循环的次数超过设定的马尔科夫链的长度 $L$ 时，进入第三阶段. 在该阶段，主要的操作是降低温度. 一般用设定好的温度更新函数来执行操作，最常用的温度更新函数为指数退温，其函数形式为 $\large T(k) = T_0 \times \alpha^{k}$， $T(k)$ 为第 $k$ 次迭代的温度， $\alpha$ 为冷却因子，是一个介于 0 和 1 之间的常数，而 $k$ 为迭代的次数. 在当前温度 $T(k)$ 更新完毕后，它会与一个设定的终止温度 $T_{end}$ 比较，如果符合终止条件，则输出当前最优解 $S$，否则将进入一个新的内循环，知道 $T(k) < T_{end}$，并输出最终结果 $S$.
  
